---
import ThemeToggle from "./ThemeToggle.astro";
---

<header class="sticky top-0 z-[1000] w-full max-w-full left-0 right-0 overflow-visible box-border bg-white/95 border-b border-gray-200 shadow-sm transition-all duration-300 ease-in-out supports-[backdrop-filter]:bg-white/85 supports-[backdrop-filter]:backdrop-blur-2xl [&.scrolled]:bg-white/98 [&.scrolled]:shadow-md [&.scrolled]:border-b [&.scrolled]:border-gray-200 [&.scrolled]:supports-[backdrop-filter]:bg-white/90 [&.hidden]:transform [&.hidden]:-translate-y-full dark:bg-gray-900/95 dark:border-gray-800 dark:shadow-[0_2px_8px_rgba(0,0,0,0.15)] dark:supports-[backdrop-filter]:bg-gray-900/75 dark:[&.scrolled]:bg-gray-900/95 dark:[&.scrolled]:shadow-[0_4px_16px_rgba(0,0,0,0.25)] dark:[&.scrolled]:supports-[backdrop-filter]:bg-gray-900/85">
  <div class="w-full mx-auto px-4 max-w-[100vw] box-border overflow-visible sm:px-6 md:px-8 lg:px-10 lg:max-w-[1400px] xl:max-w-[1600px] xl:px-12">
    <nav class="flex items-center justify-between min-h-[70px] gap-4 relative w-full max-w-full overflow-visible box-border md:min-h-20 lg:min-h-[88px] lg:gap-8" role="navigation" aria-label="Navegaci贸n principal">
      <a href="/" class="flex items-center flex-shrink-0" aria-label="Ir al inicio">
        <img src="/solucion-factura-logo.png" alt="Soluci贸n Factura" class="h-8 w-auto block md:h-9 lg:h-10" />
      </a>

      <ul class="hidden list-none m-0 p-0 items-center gap-2 flex-1 justify-center max-w-full overflow-visible box-border lg:flex lg:gap-4 xl:gap-6" role="menubar">
        <li role="none" class="m-0 p-0">
          <a class="inline-flex items-center px-3 py-2 text-[var(--text-primary)] no-underline font-medium text-[0.9rem] rounded-md transition-all duration-200 ease-in-out whitespace-nowrap relative hover:bg-[var(--border-light)] hover:text-[var(--secondary)] hover:-translate-y-px focus:outline-2 focus:outline-[var(--secondary)] focus:outline-offset-2 [&.active]:text-[var(--secondary)] [&.active]:bg-[var(--border-light)] [&.active]:relative [&.active]:after:content-[''] [&.active]:after:absolute [&.active]:after:-bottom-0.5 [&.active]:after:left-1/2 [&.active]:after:-translate-x-1/2 [&.active]:after:w-4/5 [&.active]:after:h-0.5 [&.active]:after:bg-[var(--secondary)] [&.active]:after:rounded-sm xl:px-4 xl:py-2.5 xl:text-[0.95rem]" href="/" role="menuitem">Inicio</a>
        </li>
        <li role="none" class="m-0 p-0">
          <a class="inline-flex items-center px-3 py-2 text-[var(--text-primary)] no-underline font-medium text-[0.9rem] rounded-md transition-all duration-200 ease-in-out whitespace-nowrap relative hover:bg-[var(--border-light)] hover:text-[var(--secondary)] hover:-translate-y-px focus:outline-2 focus:outline-[var(--secondary)] focus:outline-offset-2 [&.active]:text-[var(--secondary)] [&.active]:bg-[var(--border-light)] [&.active]:relative [&.active]:after:content-[''] [&.active]:after:absolute [&.active]:after:-bottom-0.5 [&.active]:after:left-1/2 [&.active]:after:-translate-x-1/2 [&.active]:after:w-4/5 [&.active]:after:h-0.5 [&.active]:after:bg-[var(--secondary)] [&.active]:after:rounded-sm xl:px-4 xl:py-2.5 xl:text-[0.95rem]" href="/#caracteristicas" role="menuitem">Caracter铆sticas</a>
        </li>
        <li role="none" class="m-0 p-0">
          <a class="inline-flex items-center px-3 py-2 text-[var(--text-primary)] no-underline font-medium text-[0.9rem] rounded-md transition-all duration-200 ease-in-out whitespace-nowrap relative hover:bg-[var(--border-light)] hover:text-[var(--secondary)] hover:-translate-y-px focus:outline-2 focus:outline-[var(--secondary)] focus:outline-offset-2 [&.active]:text-[var(--secondary)] [&.active]:bg-[var(--border-light)] [&.active]:relative [&.active]:after:content-[''] [&.active]:after:absolute [&.active]:after:-bottom-0.5 [&.active]:after:left-1/2 [&.active]:after:-translate-x-1/2 [&.active]:after:w-4/5 [&.active]:after:h-0.5 [&.active]:after:bg-[var(--secondary)] [&.active]:after:rounded-sm xl:px-4 xl:py-2.5 xl:text-[0.95rem]" href="/#planes" role="menuitem">Planes</a>
        </li>
        <li role="none" class="m-0 p-0">
          <a class="inline-flex items-center px-3 py-2 text-[var(--text-primary)] no-underline font-medium text-[0.9rem] rounded-md transition-all duration-200 ease-in-out whitespace-nowrap relative hover:bg-[var(--border-light)] hover:text-[var(--secondary)] hover:-translate-y-px focus:outline-2 focus:outline-[var(--secondary)] focus:outline-offset-2 [&.active]:text-[var(--secondary)] [&.active]:bg-[var(--border-light)] [&.active]:relative [&.active]:after:content-[''] [&.active]:after:absolute [&.active]:after:-bottom-0.5 [&.active]:after:left-1/2 [&.active]:after:-translate-x-1/2 [&.active]:after:w-4/5 [&.active]:after:h-0.5 [&.active]:after:bg-[var(--secondary)] [&.active]:after:rounded-sm xl:px-4 xl:py-2.5 xl:text-[0.95rem]" href="tel:+525593314767" role="menuitem">
             Ventas: 55 9331 4767
          </a>
        </li>
        <li role="none" class="m-0 p-0">
          <a
            class="inline-flex items-center px-3 py-2 text-[var(--text-primary)] no-underline font-medium text-[0.9rem] rounded-md transition-all duration-200 ease-in-out whitespace-nowrap relative hover:bg-[var(--border-light)] hover:text-[var(--secondary)] hover:-translate-y-px focus:outline-2 focus:outline-[var(--secondary)] focus:outline-offset-2 [&.active]:text-[var(--secondary)] [&.active]:bg-[var(--border-light)] [&.active]:relative [&.active]:after:content-[''] [&.active]:after:absolute [&.active]:after:-bottom-0.5 [&.active]:after:left-1/2 [&.active]:after:-translate-x-1/2 [&.active]:after:w-4/5 [&.active]:after:h-0.5 [&.active]:after:bg-[var(--secondary)] [&.active]:after:rounded-sm xl:px-4 xl:py-2.5 xl:text-[0.95rem]"
            href="https://wa.me/525576017764?text=Hola%20Soporte%2C%20necesito%20ayuda"
            target="_blank"
            rel="noopener noreferrer"
            role="menuitem"
          >
            <img
              src="/icons/whatsapp.svg"
              alt=""
              width="18"
              height="18"
              aria-hidden="true"
              class="mr-2 flex-shrink-0"
            />
            Soporte: 55 7601 7764
          </a>
        </li>
      </ul>

      <div class="flex items-center gap-3 flex-shrink-0 max-w-full overflow-visible box-border md:gap-4">
        <ThemeToggle />
        <a
          href="https://app.solucionfactura.mx"
          class="hidden lg:inline-flex items-center gap-2 px-3 py-2 lg:px-4 lg:py-2.5 rounded-lg font-semibold no-underline transition-all duration-200 ease-in-out border-none cursor-pointer text-sm bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-md hover:-translate-y-px hover:shadow-lg focus:outline-2 focus:outline-blue-600 focus:outline-offset-2"
          target="_blank"
          rel="noopener noreferrer"
        >
          <img
            width="24"
            height="24"
            src="/icons/user.svg"
            alt=""
            aria-hidden="true"
            class="flex-shrink-0"
          />
          Iniciar Sesi贸n
        </a>
        <button
          id="mobile-menu-toggle"
          class="flex lg:hidden items-center justify-center w-11 h-11 p-2 bg-[var(--bg-secondary)] border border-[var(--border-light)] rounded-lg cursor-pointer transition-all duration-200 ease-in-out text-[var(--text-primary)] hover:bg-[var(--border-light)] hover:border-[var(--secondary)] hover:scale-105 hover:shadow-[0_2px_8px_rgba(0,0,0,0.1)] focus:outline-2 focus:outline-[var(--secondary)] focus:outline-offset-2 [&.active]:bg-[var(--secondary)] [&.active]:border-[var(--secondary)] [&.active]:text-white [&.active]:scale-95 [data-theme='light']_&:bg-[var(--bg-primary)] [data-theme='light']_&:border-[var(--border-color)] [data-theme='light']_&:hover:bg-[var(--bg-secondary)] [data-theme='light']_&:hover:border-[var(--secondary)] [data-theme='light']_&:hover:shadow-[0_2px_8px_rgba(0,0,0,0.15)] [data-theme='light']_&.active:bg-[var(--secondary)] [data-theme='light']_&.active:text-white"
          aria-label="Abrir men煤 de navegaci贸n"
          aria-expanded="false"
          aria-controls="mobile-nav"
          type="button"
        >
          <img
            src="/icons/menu.svg"
            width="24"
            height="24"
            alt=""
            aria-hidden="true"
            class="w-6 h-6 block brightness-100 invert-0 dark:brightness-0 dark:invert transition-[filter] duration-200 [.active_&]:brightness-0 [.active_&]:invert-0"
          />
        </button>
      </div>

      <div class="hidden absolute top-full left-0 right-0 bg-[var(--bg-card)] border-t border-b border-[var(--border-light)] shadow-[0_4px_12px_rgba(0,0,0,0.15)] z-[999] supports-[backdrop-filter]:backdrop-blur-[10px] [&.active]:block [&.active]:animate-[slideDown_0.25s_ease-out] lg:hidden" id="mobile-nav" aria-hidden="true">
        <ul class="list-none p-0 m-0" role="menu">
          <li role="none" class="m-0 p-0">
            <a class="block px-6 py-4 text-[var(--text-primary)] no-underline font-medium transition-all duration-200 ease-in-out border-b border-[var(--border-light)] hover:bg-[var(--border-light)] hover:text-[var(--secondary)] focus:outline-2 focus:outline-[var(--secondary)] focus:-outline-offset-2 [&.active]:bg-[var(--border-light)] [&.active]:text-[var(--secondary)] [&.active]:border-l-[3px] [&.active]:border-l-[var(--secondary)] min-h-12 flex items-center" href="/" role="menuitem">Inicio</a>
          </li>
          <li role="none" class="m-0 p-0">
            <a class="block px-6 py-4 text-[var(--text-primary)] no-underline font-medium transition-all duration-200 ease-in-out border-b border-[var(--border-light)] hover:bg-[var(--border-light)] hover:text-[var(--secondary)] focus:outline-2 focus:outline-[var(--secondary)] focus:-outline-offset-2 [&.active]:bg-[var(--border-light)] [&.active]:text-[var(--secondary)] [&.active]:border-l-[3px] [&.active]:border-l-[var(--secondary)] min-h-12 flex items-center" href="/#caracteristicas" role="menuitem">
              Caracter铆sticas
            </a>
          </li>
          <li role="none" class="m-0 p-0">
            <a class="block px-6 py-4 text-[var(--text-primary)] no-underline font-medium transition-all duration-200 ease-in-out border-b border-[var(--border-light)] hover:bg-[var(--border-light)] hover:text-[var(--secondary)] focus:outline-2 focus:outline-[var(--secondary)] focus:-outline-offset-2 [&.active]:bg-[var(--border-light)] [&.active]:text-[var(--secondary)] [&.active]:border-l-[3px] [&.active]:border-l-[var(--secondary)] min-h-12 flex items-center" href="/#planes" role="menuitem">Planes</a>
          </li>
          <li role="none" class="m-0 p-0">
            <a
              class="block px-6 py-4 text-[var(--text-primary)] no-underline font-medium transition-all duration-200 ease-in-out border-b border-[var(--border-light)] hover:bg-[var(--border-light)] hover:text-[var(--secondary)] focus:outline-2 focus:outline-[var(--secondary)] focus:-outline-offset-2 [&.active]:bg-[var(--border-light)] [&.active]:text-[var(--secondary)] [&.active]:border-l-[3px] [&.active]:border-l-[var(--secondary)] min-h-12 flex items-center"
              href="https://wa.me/525576017764?text=Hola%20Soporte%2C%20necesito%20ayuda"
              target="_blank"
              rel="noopener noreferrer"
              role="menuitem"
            >
              Soporte WhatsApp
            </a>
          </li>
          <li role="none" class="m-0 p-0">
            <a class="block px-6 py-4 text-[var(--text-primary)] no-underline font-medium transition-all duration-200 ease-in-out border-b border-[var(--border-light)] hover:bg-[var(--border-light)] hover:text-[var(--secondary)] focus:outline-2 focus:outline-[var(--secondary)] focus:-outline-offset-2 [&.active]:bg-[var(--border-light)] [&.active]:text-[var(--secondary)] [&.active]:border-l-[3px] [&.active]:border-l-[var(--secondary)] min-h-12 flex items-center" href="tel:+525593314767" role="menuitem">
              Ventas: 55 9331 4767
            </a>
          </li>

          <li role="none" class="m-0 p-0">
            <a
              class="m-4 px-3 py-3 border-none rounded-lg text-center justify-center inline-flex items-center gap-2 font-semibold no-underline transition-all duration-200 ease-in-out cursor-pointer text-sm bg-gradient-to-br from-[var(--highlight-blue)] to-[var(--secondary)] text-[var(--gray-50)] shadow-[var(--theme-shadow-md)] hover:-translate-y-px hover:shadow-[var(--theme-shadow-lg),var(--glow)] hover:bg-gradient-to-br hover:from-[var(--secondary)] hover:to-[var(--highlight-blue)] focus:outline-2 focus:outline-[var(--secondary)] focus:outline-offset-2 [data-theme='light']_&:text-white w-[calc(100%-2rem)]"
              href="https://app.solucionfactura.mx"
              target="_blank"
              rel="noopener noreferrer"
              role="menuitem"
            >
              <img
                src="/icons/user.svg"
                alt=""
                height="24"
                width="24"
                aria-hidden="true"
              />
              Iniciar Sesi贸n
            </a>
          </li>
        </ul>
      </div>
    </nav>
  </div>
</header>

<style>
  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<script>
  import { initNavbar } from "./navbar.js";

  // Inicializar navbar cuando el DOM est茅 listo
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initNavbar);
  } else {
    initNavbar();
  }

  // Re-inicializar en navegaci贸n de Astro
  document.addEventListener("astro:page-load", initNavbar);
</script>
